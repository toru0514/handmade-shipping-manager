# UC-010: 定型文を設定する

## 基本情報

| 項目 | 内容 |
|-----|------|
| ユースケースID | UC-010 |
| ユースケース名 | 定型文を設定する |
| アクター | 作家 |
| 優先度 | 高 |
| ステータス | 未実装 |

## 概要

購入お礼メッセージ（UC-008）と発送連絡メッセージ（UC-009）で使用する定型文テンプレートを設定・編集する。

## 事前条件

- 作家がアプリにアクセスしていること

## 事後条件

- 定型文テンプレートが保存されている
- 次回のメッセージ生成時に新しいテンプレートが使用される

## 基本フロー

1. 作家は設定画面から「定型文設定」を選択する
2. システムは現在の定型文テンプレートを表示する
3. 作家は編集したいテンプレート（購入お礼 / 発送連絡）を選択する
4. 作家はテンプレートを編集する
5. 作家は「保存」ボタンをクリックする
6. システムはテンプレートを保存する
7. システムは「保存しました」とメッセージを表示する

## 代替フロー

### 3a. プレビューを確認する場合
1. 作家は「プレビュー」ボタンをクリックする
2. システムはサンプルデータを使ってメッセージをプレビュー表示する
3. 作家は内容を確認する

### 5a. デフォルトに戻す場合
1. 作家は「デフォルトに戻す」ボタンをクリックする
2. システムは確認ダイアログを表示する
3. 作家は「戻す」を選択する
4. システムはテンプレートをデフォルトに戻す

### 5b. 変数を挿入する場合
1. 作家は「変数を挿入」ボタンをクリックする
2. システムは利用可能な変数の一覧を表示する
3. 作家は挿入したい変数を選択する
4. システムはカーソル位置に変数を挿入する

## 関連ドメインルール

このユースケースで適用されるドメインルール（[詳細](../domain/README.md#ドメインルールdomain-rules)）:

| ルールID | ルール名 | 説明 |
|---------|---------|------|
| DR-MSG-001 | 空テンプレート禁止 | 空のテンプレートは保存できない |
| DR-MSG-002 | 変数必須 | テンプレートは必ず1つ以上の変数を含む必要がある |

### アプリケーションルール

- テンプレートは即座に反映される

## 非機能要件

- 保存処理は1秒以内に完了する
- プレビュー表示は即時

## 画面・UI

### 定型文設定画面

```
┌─────────────────────────────────────────────────────────────────────┐
│ ⚙️ 定型文設定                                                        │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  [購入お礼]  [発送連絡] ←タブ切り替え                               │
│                                                                     │
│  ─────────────────────────────────────────────────────────────────  │
│                                                                     │
│  📝 購入お礼メッセージ テンプレート                                  │
│                                                                     │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │ {{buyer_name}} 様                                           │   │
│  │                                                             │   │
│  │ この度は「{{product_name}}」をご購入いただき、              │   │
│  │ 誠にありがとうございます。                                  │   │
│  │                                                             │   │
│  │ 心を込めてお作りした作品です。                              │   │
│  │ 発送準備が整いましたら、改めてご連絡いたします。             │   │
│  │                                                             │   │
│  │ ご不明な点がございましたら、お気軽にお問い合わせください。   │   │
│  │                                                             │   │
│  │ 今後ともよろしくお願いいたします。                          │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│  [+ 変数を挿入 ▼]                                                   │
│                                                                     │
│  ─────────────────────────────────────────────────────────────────  │
│                                                                     │
│  📋 利用可能な変数                                                  │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │ {{buyer_name}}    - 購入者名                                │   │
│  │ {{product_name}}  - 商品名                                  │   │
│  │ {{price}}         - 金額                                    │   │
│  │ {{order_id}}      - 注文番号                                │   │
│  │ {{platform}}      - プラットフォーム                        │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│  ─────────────────────────────────────────────────────────────────  │
│                                                                     │
│  [デフォルトに戻す]        [プレビュー]  [キャンセル]  [保存]       │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 発送連絡タブ

```
┌─────────────────────────────────────────────────────────────────────┐
│ ⚙️ 定型文設定                                                        │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  [購入お礼]  [発送連絡] ←選択中                                     │
│                                                                     │
│  ─────────────────────────────────────────────────────────────────  │
│                                                                     │
│  📝 発送連絡メッセージ テンプレート                                  │
│                                                                     │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │ {{buyer_name}} 様                                           │   │
│  │                                                             │   │
│  │ お待たせいたしました。                                      │   │
│  │ 本日、{{shipping_method}}にて発送いたしました。             │   │
│  │                                                             │   │
│  │ {{#if tracking_number}}                                     │   │
│  │ 追跡番号: {{tracking_number}}                               │   │
│  │ 追跡URL: {{tracking_url}}                                   │   │
│  │ {{/if}}                                                     │   │
│  │                                                             │   │
│  │ 届きましたら、ご確認をお願いいたします。                     │   │
│  │                                                             │   │
│  │ この度はご購入いただき、ありがとうございました。             │   │
│  │ またのご利用を心よりお待ちしております。                     │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│  [+ 変数を挿入 ▼]                                                   │
│                                                                     │
│  ─────────────────────────────────────────────────────────────────  │
│                                                                     │
│  📋 利用可能な変数                                                  │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │ {{buyer_name}}       - 購入者名                             │   │
│  │ {{shipping_method}}  - 発送方法                             │   │
│  │ {{tracking_number}}  - 追跡番号                             │   │
│  │ {{tracking_url}}     - 追跡URL（自動生成）                  │   │
│  │ {{shipped_at}}       - 発送日時                             │   │
│  │ {{product_name}}     - 商品名                               │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│  ─────────────────────────────────────────────────────────────────  │
│                                                                     │
│  [デフォルトに戻す]        [プレビュー]  [キャンセル]  [保存]       │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### プレビューダイアログ

```
┌─────────────────────────────────────────────────────────────────┐
│ 👁️ プレビュー                                                    │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  以下のサンプルデータでプレビューしています:                      │
│  購入者名: 山田 太郎 / 商品名: ハンドメイドアクセサリー           │
│                                                                 │
│  ─────────────────────────────────────────────────────────────  │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ 山田 太郎 様                                             │   │
│  │                                                         │   │
│  │ この度は「ハンドメイドアクセサリー」をご購入いただき、    │   │
│  │ 誠にありがとうございます。                               │   │
│  │                                                         │   │
│  │ 心を込めてお作りした作品です。                           │   │
│  │ 発送準備が整いましたら、改めてご連絡いたします。          │   │
│  │                                                         │   │
│  │ ご不明な点がございましたら、お気軽にお問い合わせください。│   │
│  │                                                         │   │
│  │ 今後ともよろしくお願いいたします。                       │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│                                                    [閉じる]      │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 変数挿入ドロップダウン

```
┌─────────────────────────────────┐
│ + 変数を挿入                    │
├─────────────────────────────────┤
│ {{buyer_name}}    購入者名      │
│ {{product_name}}  商品名        │
│ {{price}}         金額          │
│ {{order_id}}      注文番号      │
│ {{platform}}      プラットフォーム│
└─────────────────────────────────┘
```

## データ

### 入力データ
- テンプレート種別（購入お礼 / 発送連絡）
- テンプレート本文

### 出力データ
- 保存されたテンプレート

### データ保存先
- テンプレートはローカルストレージまたはスプレッドシートの設定シートに保存

## 関連ユースケース

- UC-008: 購入お礼メッセージを作成する（テンプレート使用元）
- UC-009: 発送連絡メッセージを作成する（テンプレート使用元）

## 備考

- 将来的には複数のテンプレートを保存して切り替える機能も検討
- プラットフォーム（minne/creema）ごとに異なるテンプレートを設定する機能も検討
- テンプレートのインポート/エクスポート機能も将来的に検討
